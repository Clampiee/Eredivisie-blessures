function translateReason(e){return translationMap[e]||e}function formatDateInDutch(e){const t={day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit",hour12:!1};return new Intl.DateTimeFormat("nl-NL",t).format(e)}async function getNextFixtureForTeam(e){const t=`${nextFixtureUrl}?team=${e}&next=1`,n=await fetch(t,optionsNextFixture),a=await n.json();return a.response&&a.response.length>0?a.response[0]:null}function getRelevantFixture(e){const t=e.filter(e=>new Date(e.fixture.date)>new Date),n=e.filter(e=>new Date(e.fixture.date)<=new Date);if(t.length>0)return t[0];const a=n.sort((e,t)=>new Date(t.fixture.date)-new Date(e.fixture.date))[0];return a}function generateNavMenu(e){const t=document.querySelector("nav ul");t.innerHTML="",Object.keys(e).sort((e,t)=>e.localeCompare(t)).forEach(n=>{const a=e[n][0].team,r=document.createElement("li"),s=document.createElement("a");s.href=`#team-${n.replace(/\s+/g,"-")}`,s.title=n;const o=document.createElement("img");o.src=a.logo,o.alt=n,o.classList.add("header-logo"),s.appendChild(o),r.appendChild(s),t.appendChild(r)})}async function fetchInjuriesForFixture(){const e="missingPlayersData",t="missingPlayersDataExpiration",n=432e5;try{const a=localStorage.getItem(e),r=localStorage.getItem(t),s=Date.now();if(a&&r&&s-r<n)return void processMissingPlayers(JSON.parse(a).response);const o=await fetch(url,options),i=await o.json();if(!i.response||!Array.isArray(i.response))throw new Error("Unexpected API response format");for(let e of i.response){const t=e.team.id,n=await getNextFixtureForTeam(t);if(n){e.players&&Array.isArray(e.players)||(e.players=[]);const t=new Date(n.fixture.date);e.players=e.players.filter(e=>e.fixture&&new Date(e.fixture.date).getTime()===t.getTime())}}localStorage.setItem(e,JSON.stringify(i)),localStorage.setItem(t,s.toString()),processMissingPlayers(i.response)}catch(e){console.error("Error fetching missing players:",e)}}function processMissingPlayers(e){if(!Array.isArray(e)||0===e.length){console.log("No missing players found or invalid data structure.");const e=document.getElementById("injury-list");return void(e.innerHTML="<li>No missing or questionable players available.</li>")}const t=document.getElementById("injury-list");t.innerHTML="";const n={};e.forEach(e=>{const t=e.team.name;n[t]||(n[t]=[]),n[t].push(e)}),generateNavMenu(n),Object.keys(n).sort((e,t)=>e.localeCompare(t)).forEach(e=>{const a=document.createElement("div");a.classList.add("team-data"),a.id=`team-${e.replace(/\s+/g,"-")}`;const r=document.createElement("div");r.classList.add("team-header");const s=document.createElement("img");s.src=n[e][0].team.logo,s.alt=e,s.width=40,s.height=40,s.classList.add("team-logo");const o=document.createElement("div");o.classList.add("team-info");const i=document.createElement("h3");i.textContent=`${e} - Blessures en schorsingen`;const l=getRelevantFixture(n[e]),c=new Date(l.fixture.date),d=formatDateInDutch(c),u=document.createElement("p");c>new Date?u.textContent=`${translationMap["Next fixture"]}: ${d}`:u.textContent=`${translationMap["Next fixture"]}: Nog niet beschikbaar (Afwezigen zijn van afgelopen speelronde)`,o.append(i,u),r.append(s,o),a.appendChild(r);const p=document.createElement("p");p.textContent="Afwezigen",a.appendChild(p);const m=document.createElement("ul");if(m.classList.add("player-list"),n[e].forEach(e=>{const t=new Date(e.fixture.date),n=new Date(l.fixture.date);if(t.getTime()===n.getTime()&&("Missing Fixture"===e.player.type||"Questionable"===e.player.type)){const t=document.createElement("li");t.classList.add("player-item");let n=` \n                        <img src="${e.player.photo}" alt="${e.player.name}" width="40" height="40">\n                        <strong>${e.player.name}</strong>&nbsp;-&nbsp;\n                        <span class="reason-text">${translateReason(e.player.reason||"Onbekend")}</span>\n                    `;"Questionable"===e.player.type&&(n=n.replace(`<strong>${e.player.name}</strong>`,`<strong>${e.player.name} (Twijfelachtig)</strong>`)),t.innerHTML=n;const a=t.querySelector(".reason-text");a.classList.add("player-reason"),"Questionable"===e.player.type&&t.classList.add("questionable"),m.appendChild(t)}}),0===m.children.length){const e=document.createElement("li");e.textContent="Ontbrekende spelers nog niet bekend",m.appendChild(e)}a.appendChild(m),t.appendChild(a)})}const translationMap={Reason:"Reden","Next fixture":"Volgende wedstrijd","Muscle Injury":"Spierblessure","Ankle Injury":"Enkelblessure","Toe Injury":"Teenblessure","Knee Injury":"Knieblessure",Injury:"Blessure","Ribs Injury":"Ribblessure","Eye injury":"Oogblessure","Leg Injury":"Beenblessure","Broken ankle":"Gebroken enkel","Yellow Cards":"Te veel gele kaarten","Broken nose":"Gebroken neus","Foot Injury":"Voetblessure",Inactive:"Inactief","Lacking Match Fitness":"Niet fit genoeg","Groin Injury":"Liesblessure","Back Injury":"Rugblessure","Broken Leg":"Gebroken been","Achilles Tendon Injury":"Achillespeesblessure","Arm Injury":"Armblessure",Overload:"Overbelasting",Knock:"Kneuzing"},url="https://api-football-v1.p.rapidapi.com/v3/injuries?league=88&season=2024",nextFixtureUrl="https://api-football-v1.p.rapidapi.com/v3/fixtures",options={method:"GET",headers:{"x-rapidapi-key":"bd4ddb76f9mshd1652ebb1e8c2cfp15d7a6jsn1bc7a21d5700","x-rapidapi-host":"api-football-v1.p.rapidapi.com"}},optionsNextFixture={method:"GET",headers:{"x-rapidapi-key":"bd4ddb76f9mshd1652ebb1e8c2cfp15d7a6jsn1bc7a21d5700","x-rapidapi-host":"api-football-v1.p.rapidapi.com"}};fetchInjuriesForFixture(),setInterval(fetchInjuriesForFixture,432e5);
